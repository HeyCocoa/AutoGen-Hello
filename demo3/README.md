# NMPA 医疗器械数据采集

这是一个“两阶段采集 + 规则筛选 + 断点续传”的流程：先用关键词把列表页跑一遍，按规则筛掉不相关的条目；再用注册证编号逐条进详情页补全字段。这样既绕开分页回退的问题，也能在反爬限制下稳定拿到结构化的 Excel 结果。

## 工作流与设计理由（每点一句）

1. **列表页采集**：关键词驱动遍历列表页，先把可见信息尽量捞全。  
2. **规则初筛**：用 `FILTER_RULES` 把明显不匹配的结果剔掉，降低后续负担。  
3. **人工复核**：第一阶段输出分 sheet 的 Excel，方便快速删减。  
4. **详情页补全**：用注册证编号直搜详情页，避免分页回退重置。  
5. **断点续传**：读取已存在的 `nmpa_data.xlsx`，中断后不必重跑。  
6. **分批保存**：每 10 条落盘一次，减少意外中断的损失。  

## 关键文件

- `phase1_collect.py`：列表页采集 + 初筛  
- `phase2_detail.py`：详情页采集 + 断点续传  
- `keywords.py`：产品、关键词、筛选规则  
- `browser_utils.py`：浏览器与反爬相关的工具  
- `phase1_result.xlsx`：第一阶段输出  
- `nmpa_data.xlsx`：最终详情数据  
